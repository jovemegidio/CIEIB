<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Área do Ministro - CIEIB - Convenção das Igrejas Evangélicas Interdenominacional do Brasil">
    <title>CIEIB: Área do Ministro</title>
    <link rel="icon" type="image/jpeg" href="/fav.jpg">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#1a3a5c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CIEIB">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192x192.png">
    <meta name="msapplication-TileImage" content="/icons/icon-144x144.png">
    <meta name="msapplication-TileColor" content="#1a3a5c">
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&family=Open+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

    <!-- Skip to content -->
    <a href="#main-content" class="sr-only sr-only-focusable">Pular para o conteúdo principal</a>

    <!-- Top Bar -->
    <div class="top-bar">
        <div class="container">
            <div class="top-bar-content">
                <div class="top-bar-left">
                    <span><i class="fas fa-clock"></i> <span data-config="site_horario">Seg a Sex: 09h às 17h</span></span>
                    <span><i class="fas fa-phone"></i> <span data-config="site_telefone">(00) 0000-0000</span></span>
                    <span><i class="fas fa-envelope"></i> <span data-config="site_email">contato@cieib.org.br</span></span>
                </div>
                <div class="top-bar-right" id="topBarSocial">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                    <a href="#" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="header" id="header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-dove"></i>
                    </div>
                    <div class="logo-text">
                        <span class="logo-name">CIEIB</span>
                        <span class="logo-desc">Convenção das Igrejas Evangélicas<br>Interdenominacional do Brasil</span>
                    </div>
                </a>
                <nav class="nav" id="nav" aria-label="Navegação principal">
                    <ul class="nav-list">
                        <li><a href="index.html">Home</a></li>
                        <li class="dropdown">
                            <a href="#">Institucional <i class="fas fa-chevron-down"></i></a>
                            <ul class="dropdown-menu">
                                <li><a href="quem-somos.html">Quem Somos</a></li>
                                <li><a href="diretoria.html">Diretoria</a></li>
                                <li><a href="diretoria.html#presidente">Presidente</a></li>
                                <li><a href="quem-somos.html#estrutura">Conselhos</a></li>
                                <li><a href="quem-somos.html#estrutura">Comissões</a></li>
                                <li><a href="quem-somos.html#estrutura">Órgãos</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#">Convenções <i class="fas fa-chevron-down"></i></a>
                            <ul class="dropdown-menu">
                                <li><a href="index.html#convencoes-section">Convenções Afiliadas</a></li>
                                <li><a href="index.html#eventos">Assembleias Convencionais</a></li>
                                <li><a href="index.html#resolucoes">Resoluções</a></li>
                            </ul>
                        </li>
                        <li><a href="noticias.html">Notícias</a></li>
                        <li><a href="midias.html">Mídias</a></li>
                        <li><a href="contato.html">Contato</a></li>
                        <li class="nav-cta"><a href="area-do-ministro.html" class="active"><i class="fas fa-user-shield"></i> Área do Ministro</a></li>
                    </ul>
                </nav>
                <button class="mobile-toggle" id="mobileToggle" aria-label="Menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main id="main-content">

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1><i class="fas fa-user-shield" style="margin-right: 12px;"></i>Área do Ministro</h1>
            <nav aria-label="Breadcrumb">
                <div class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span>/</span>
                    <span aria-current="page">Área do Ministro</span>
                </div>
            </nav>
        </div>
    </section>

    <!-- Login Section -->
    <section class="page-content" style="background: var(--light);">
        <div class="container">
            <div class="am-page-grid">
                <!-- Login Panel -->
                <div class="am-login-panel">
                    <div class="am-login-card am-login-card-page">
                        <div class="am-card-header">
                            <div class="am-card-icon">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <h3>Acesse sua conta</h3>
                            <p>Entre com seus dados para acessar a área exclusiva do ministro.</p>
                        </div>
                        <form class="am-login-form" id="ministerLoginForm">
                            <div class="am-form-group">
                                <label for="loginCpf"><i class="fas fa-user" aria-hidden="true"></i> CPF ou Nº da Credencial</label>
                                <input type="text" id="loginCpf" placeholder="Digite seu CPF ou número da credencial" required>
                            </div>
                            <div class="am-form-group">
                                <label for="loginPassword"><i class="fas fa-lock" aria-hidden="true"></i> Senha</label>
                                <div class="am-password-group">
                                    <input type="password" id="loginPassword" placeholder="Digite sua senha" required>
                                    <button type="button" class="am-toggle-password" onclick="togglePassword()" aria-label="Mostrar ou ocultar senha">
                                        <i class="fas fa-eye" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="am-form-options">
                                <label class="am-checkbox">
                                    <input type="checkbox"> 
                                    <span>Lembrar-me</span>
                                </label>
                                <a href="contato.html" class="am-forgot">Esqueci minha senha</a>
                            </div>
                            <button type="submit" class="btn btn-primary am-login-btn">
                                <i class="fas fa-sign-in-alt"></i> Entrar
                            </button>
                        </form>
                        <div class="am-login-footer">
                            <div class="am-divider">
                                <span>ou</span>
                            </div>
                            <a href="#" class="btn btn-outline am-first-access" id="btnPrimeiroAcesso" style="color: var(--primary); border-color: var(--primary);">
                                <i class="fas fa-user-plus"></i> Primeiro Acesso
                            </a>
                            <p class="am-help-text">
                                Problemas para acessar? <a href="contato.html">Fale conosco</a>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Services Panel -->
                <div class="am-services-panel">
                    <h2 style="margin-bottom: 8px;">Serviços Disponíveis</h2>
                    <p style="color: var(--gray); margin-bottom: 32px;">Confira os serviços disponíveis na área exclusiva do ministro credenciado.</p>

                    <div class="am-services-grid">
                        <div class="am-service-card">
                            <div class="am-service-icon">
                                <i class="fas fa-id-card"></i>
                            </div>
                            <h4>Credencial Digital</h4>
                            <p>Acesse e baixe sua credencial ministerial digital válida em todo o território nacional.</p>
                        </div>

                        <div class="am-service-card">
                            <div class="am-service-icon">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <h4>Emissão de Documentos</h4>
                            <p>Emita cartas de recomendação, declarações e outros documentos oficiais da convenção.</p>
                        </div>

                        <div class="am-service-card">
                            <div class="am-service-icon">
                                <i class="fas fa-clipboard-check"></i>
                            </div>
                            <h4>Situação Cadastral</h4>
                            <p>Verifique sua situação cadastral, anuidades e regularidade junto à convenção.</p>
                        </div>

                        <div class="am-service-card">
                            <div class="am-service-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <h4>Inscrição em Eventos</h4>
                            <p>Inscreva-se nos congressos, seminários e assembleias promovidas pela CIEIB.</p>
                        </div>

                        <div class="am-service-card">
                            <div class="am-service-icon">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <h4>Cursos e Capacitação</h4>
                            <p>Acesse cursos de formação teológica e capacitação ministerial online e presencial.</p>
                        </div>

                        <div class="am-service-card">
                            <div class="am-service-icon">
                                <i class="fas fa-user-edit"></i>
                            </div>
                            <h4>Atualização Cadastral</h4>
                            <p>Mantenha seus dados pessoais, endereço e informações ministeriais sempre atualizados.</p>
                        </div>

                        <div class="am-service-card">
                            <div class="am-service-icon">
                                <i class="fas fa-barcode"></i>
                            </div>
                            <h4>Boletos e Pagamentos</h4>
                            <p>Emita boletos de anuidade, 2ª via e consulte seu histórico de pagamentos.</p>
                        </div>

                        <div class="am-service-card">
                            <div class="am-service-icon">
                                <i class="fas fa-church"></i>
                            </div>
                            <h4>Minha Igreja</h4>
                            <p>Gerencie as informações da sua congregação, membros e relatórios pastorais.</p>
                        </div>
                    </div>

                    <!-- Info boxes -->
                    <div class="am-info-boxes">
                        <div class="am-info-box">
                            <div class="am-info-icon"><i class="fas fa-headset"></i></div>
                            <div>
                                <h4>Suporte ao Ministro</h4>
                                <p>Precisa de ajuda? Nossa equipe está disponível de segunda a sexta, das 09h às 17h.</p>
                                <a href="contato.html" class="btn-link">Fale conosco <i class="fas fa-arrow-right"></i></a>
                            </div>
                        </div>
                        <div class="am-info-box">
                            <div class="am-info-icon"><i class="fas fa-user-plus"></i></div>
                            <div>
                                <h4>Quer se filiar?</h4>
                                <p>Conheça os requisitos para credenciamento e filiação de ministros à CIEIB.</p>
                                <a href="#" id="btnFiliar" class="btn-link">Saiba mais <i class="fas fa-arrow-right"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    </main>

    <!-- ==================== MODAL PRIMEIRO ACESSO ==================== -->
    <div class="reg-overlay" id="regOverlay">
        <div class="reg-modal">
            <button class="reg-close" id="regClose" aria-label="Fechar">&times;</button>

            <!-- Progress Steps -->
            <div class="reg-steps">
                <div class="reg-step active" data-step="1">
                    <div class="reg-step-num">1</div>
                    <span>Dados Pessoais</span>
                </div>
                <div class="reg-step" data-step="2">
                    <div class="reg-step-num">2</div>
                    <span>Endereço</span>
                </div>
                <div class="reg-step" data-step="3">
                    <div class="reg-step-num">3</div>
                    <span>Ministerial</span>
                </div>
                <div class="reg-step" data-step="4">
                    <div class="reg-step-num">4</div>
                    <span>Documentos</span>
                </div>
            </div>

            <form id="regForm" novalidate>
                <!-- ===== ETAPA 1: DADOS PESSOAIS ===== -->
                <div class="reg-panel active" id="regPanel1">
                    <div class="reg-panel-header">
                        <i class="fas fa-user"></i>
                        <h3>Dados Pessoais</h3>
                        <p>Preencha suas informações básicas</p>
                    </div>
                    <div class="reg-grid-2">
                        <div class="reg-field full">
                            <label>Nome Completo *</label>
                            <input type="text" id="regNome" required placeholder="Seu nome completo">
                        </div>
                        <div class="reg-field">
                            <label>CPF *</label>
                            <input type="text" id="regCpf" required placeholder="000.000.000-00" maxlength="14">
                        </div>
                        <div class="reg-field">
                            <label>RG *</label>
                            <input type="text" id="regRg" required placeholder="Número do RG">
                        </div>
                        <div class="reg-field">
                            <label>Órgão Expedidor</label>
                            <input type="text" id="regOrgao" placeholder="Ex: SSP SP">
                        </div>
                        <div class="reg-field">
                            <label>Data de Nascimento *</label>
                            <input type="date" id="regNascimento" required>
                        </div>
                        <div class="reg-field">
                            <label>Sexo *</label>
                            <select id="regSexo" required>
                                <option value="">Selecione</option>
                                <option value="M">Masculino</option>
                                <option value="F">Feminino</option>
                            </select>
                        </div>
                        <div class="reg-field">
                            <label>Nacionalidade</label>
                            <input type="text" id="regNacionalidade" value="BRASILEIRO" placeholder="Nacionalidade">
                        </div>
                        <div class="reg-field">
                            <label>Estado de Nascimento</label>
                            <select id="regEstadoNasc">
                                <option value="">Selecione UF</option>
                                <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                                <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                                <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                                <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                                <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                                <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                                <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                                <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                                <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                            </select>
                        </div>
                        <div class="reg-field">
                            <label>Cidade de Nascimento *</label>
                            <input type="text" id="regCidadeNasc" required placeholder="Cidade">
                        </div>
                        <div class="reg-field">
                            <label>Estado Civil *</label>
                            <select id="regEstadoCivil" required>
                                <option value="">Selecione</option>
                                <option value="solteiro">Solteiro(a)</option>
                                <option value="casado">Casado(a)</option>
                                <option value="divorciado">Divorciado(a)</option>
                                <option value="viuvo">Viúvo(a)</option>
                            </select>
                        </div>
                        <div class="reg-field" id="regConjugeGroup" style="display:none;">
                            <label>Nome do Cônjuge</label>
                            <input type="text" id="regConjuge" placeholder="Nome completo do cônjuge">
                        </div>
                        <div class="reg-field" id="regConjugeNascGroup" style="display:none;">
                            <label>Nasc. Cônjuge</label>
                            <input type="date" id="regConjugeNasc">
                        </div>
                        <div class="reg-field">
                            <label>Nome do Pai *</label>
                            <input type="text" id="regPai" required placeholder="Nome completo">
                        </div>
                        <div class="reg-field">
                            <label>Nome da Mãe *</label>
                            <input type="text" id="regMae" required placeholder="Nome completo">
                        </div>
                        <div class="reg-field">
                            <label>Email *</label>
                            <input type="email" id="regEmail" required placeholder="seu@email.com">
                        </div>
                        <div class="reg-field">
                            <label>Telefone *</label>
                            <input type="text" id="regTelefone" required placeholder="(00) 0000-0000" maxlength="15">
                        </div>
                        <div class="reg-field">
                            <label>WhatsApp</label>
                            <input type="text" id="regWhatsapp" placeholder="(00) 00000-0000" maxlength="15">
                        </div>
                        <div class="reg-field">
                            <label>Escolaridade *</label>
                            <select id="regEscolaridade" required>
                                <option value="">Selecione</option>
                                <option value="fundamental">Ensino Fundamental</option>
                                <option value="medio">Ensino Médio</option>
                                <option value="tecnico">Ensino Técnico</option>
                                <option value="superior_incompleto">Superior Incompleto</option>
                                <option value="superior">Ensino Superior</option>
                                <option value="pos_graduacao">Pós-Graduação</option>
                                <option value="mestrado">Mestrado</option>
                                <option value="doutorado">Doutorado</option>
                            </select>
                        </div>

                        <!-- Filhos -->
                        <div class="reg-field full">
                            <label>Filhos</label>
                            <div id="regFilhosContainer"></div>
                            <button type="button" class="reg-btn-add" id="btnAddFilho">
                                <i class="fas fa-plus-circle"></i> Adicionar filho(a)
                            </button>
                        </div>
                    </div>
                    <div class="reg-actions">
                        <span></span>
                        <button type="button" class="reg-btn-next" onclick="regNextStep(2)">Próximo <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>

                <!-- ===== ETAPA 2: ENDEREÇO ===== -->
                <div class="reg-panel" id="regPanel2">
                    <div class="reg-panel-header">
                        <i class="fas fa-map-marker-alt"></i>
                        <h3>Endereço</h3>
                        <p>Dados de localização residencial</p>
                    </div>
                    <div class="reg-grid-2">
                        <div class="reg-field">
                            <label>CEP *</label>
                            <input type="text" id="regCep" required placeholder="00000-000" maxlength="9">
                        </div>
                        <div class="reg-field full">
                            <label>Endereço</label>
                            <input type="text" id="regEndereco" placeholder="Rua, Avenida...">
                        </div>
                        <div class="reg-field" style="max-width:120px;">
                            <label>Número</label>
                            <input type="text" id="regNumero" placeholder="Nº">
                        </div>
                        <div class="reg-field">
                            <label>Complemento</label>
                            <input type="text" id="regComplemento" placeholder="Apto, Bloco...">
                        </div>
                        <div class="reg-field">
                            <label>Bairro</label>
                            <input type="text" id="regBairro" placeholder="Bairro">
                        </div>
                        <div class="reg-field">
                            <label>Cidade</label>
                            <input type="text" id="regCidade" placeholder="Cidade">
                        </div>
                        <div class="reg-field">
                            <label>UF</label>
                            <select id="regUf">
                                <option value="">UF</option>
                                <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                                <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                                <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                                <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                                <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                                <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                                <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                                <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                                <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                            </select>
                        </div>
                    </div>
                    <div class="reg-actions">
                        <button type="button" class="reg-btn-prev" onclick="regNextStep(1)"><i class="fas fa-arrow-left"></i> Voltar</button>
                        <button type="button" class="reg-btn-next" onclick="regNextStep(3)">Próximo <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>

                <!-- ===== ETAPA 3: DADOS MINISTERIAIS + SENHA ===== -->
                <div class="reg-panel" id="regPanel3">
                    <div class="reg-panel-header">
                        <i class="fas fa-cross"></i>
                        <h3>Dados Ministeriais</h3>
                        <p>Informações sobre seu ministério</p>
                    </div>
                    <div class="reg-grid-2">
                        <div class="reg-field">
                            <label>Cargo / Título Ministerial *</label>
                            <select id="regCargo" required>
                                <option value="">Selecione</option>
                                <option value="PASTOR">Pastor</option>
                                <option value="PASTORA">Pastora</option>
                                <option value="APOSTOLO">Apóstolo</option>
                                <option value="BISPO">Bispo(a)</option>
                                <option value="EVANGELISTA">Evangelista</option>
                                <option value="MISSIONARIO">Missionário(a)</option>
                                <option value="PRESBITERO">Presbítero</option>
                                <option value="DIACONO">Diácono/Diaconisa</option>
                                <option value="OBREIRO">Obreiro(a)</option>
                                <option value="LIDER">Líder</option>
                                <option value="OUTRO">Outro</option>
                            </select>
                        </div>
                        <div class="reg-field">
                            <label>Função Ministerial</label>
                            <input type="text" id="regFuncao" placeholder="Ex: Pastor Titular, Auxiliar...">
                        </div>
                        <div class="reg-field full">
                            <label>Nome da Igreja / Congregação</label>
                            <input type="text" id="regIgreja" placeholder="Nome da igreja onde congrega/pastoreia">
                        </div>
                        <div class="reg-field">
                            <label>Tempo de Ministério</label>
                            <select id="regTempoMinisterio">
                                <option value="">Selecione</option>
                                <option value="menos_1">Menos de 1 ano</option>
                                <option value="1_3">1 a 3 anos</option>
                                <option value="3_5">3 a 5 anos</option>
                                <option value="5_10">5 a 10 anos</option>
                                <option value="10_20">10 a 20 anos</option>
                                <option value="mais_20">Mais de 20 anos</option>
                            </select>
                        </div>
                        <div class="reg-field">
                            <label>Data de Consagração</label>
                            <input type="date" id="regConsagracao">
                        </div>
                        <div class="reg-field">
                            <label>Data de Batismo</label>
                            <input type="date" id="regDataBatismo">
                        </div>
                        <div class="reg-field">
                            <label>Data da Ordenação</label>
                            <input type="date" id="regDataOrdenacao">
                        </div>
                        <div class="reg-field full">
                            <label>Igreja onde foi Ordenado</label>
                            <input type="text" id="regIgrejaOrdenacao" placeholder="Nome da igreja onde foi ordenado(a)">
                        </div>
                        <div class="reg-field">
                            <label>Cidade da Ordenação</label>
                            <input type="text" id="regCidadeOrdenacao" placeholder="Cidade onde foi ordenado(a)">
                        </div>
                    </div>

                    <div class="reg-actions">
                        <button type="button" class="reg-btn-prev" onclick="regNextStep(2)"><i class="fas fa-arrow-left"></i> Voltar</button>
                        <button type="button" class="reg-btn-next reg-btn-submit" id="regSubmitBtn" onclick="regSubmitForm()">
                            <i class="fas fa-check-circle"></i> Cadastrar e Continuar
                        </button>
                    </div>
                </div>

                <!-- ===== ETAPA 4: UPLOAD DE DOCUMENTOS ===== -->
                <div class="reg-panel" id="regPanel4">
                    <div class="reg-panel-header">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3>Envio de Documentos</h3>
                        <p>Envie os documentos para validação do seu cadastro</p>
                    </div>

                    <div class="reg-docs-list">
                        <div class="reg-doc-item reg-doc-required" data-tipo="foto_3x4">
                            <div class="reg-doc-info">
                                <i class="fas fa-camera"></i>
                                <div>
                                    <strong>Foto 3x4 <span class="reg-doc-obrig">* Obrigatório</span></strong>
                                    <small>Foto recente para credencial (JPG ou PNG)</small>
                                </div>
                            </div>
                            <label class="reg-doc-btn">
                                <i class="fas fa-paperclip"></i> Escolher
                                <input type="file" accept="image/*" class="reg-doc-input" data-tipo="foto_3x4" data-required="true" hidden>
                            </label>
                            <span class="reg-doc-status"></span>
                        </div>

                        <div class="reg-doc-item reg-doc-required" data-tipo="documento_identidade">
                            <div class="reg-doc-info">
                                <i class="fas fa-id-card"></i>
                                <div>
                                    <strong>RG <span class="reg-doc-obrig">* Obrigatório</span></strong>
                                    <small>Documento de identidade com foto</small>
                                </div>
                            </div>
                            <label class="reg-doc-btn">
                                <i class="fas fa-paperclip"></i> Escolher
                                <input type="file" accept="image/*,.pdf" class="reg-doc-input" data-tipo="documento_identidade" data-required="true" hidden>
                            </label>
                            <span class="reg-doc-status"></span>
                        </div>

                        <div class="reg-doc-item reg-doc-required" data-tipo="cpf_documento">
                            <div class="reg-doc-info">
                                <i class="fas fa-file-alt"></i>
                                <div>
                                    <strong>CPF <span class="reg-doc-obrig">* Obrigatório</span></strong>
                                    <small>Foto ou cópia do CPF</small>
                                </div>
                            </div>
                            <label class="reg-doc-btn">
                                <i class="fas fa-paperclip"></i> Escolher
                                <input type="file" accept="image/*,.pdf" class="reg-doc-input" data-tipo="cpf_documento" data-required="true" hidden>
                            </label>
                            <span class="reg-doc-status"></span>
                        </div>

                        <div class="reg-doc-item reg-doc-required" data-tipo="comprovante_endereco">
                            <div class="reg-doc-info">
                                <i class="fas fa-home"></i>
                                <div>
                                    <strong>Comprovante de Residência <span class="reg-doc-obrig">* Obrigatório</span></strong>
                                    <small>Conta de luz, água ou telefone recente</small>
                                </div>
                            </div>
                            <label class="reg-doc-btn">
                                <i class="fas fa-paperclip"></i> Escolher
                                <input type="file" accept="image/*,.pdf" class="reg-doc-input" data-tipo="comprovante_endereco" data-required="true" hidden>
                            </label>
                            <span class="reg-doc-status"></span>
                        </div>

                        <div class="reg-doc-item reg-doc-required" data-tipo="credencial_eclesiastica">
                            <div class="reg-doc-info">
                                <i class="fas fa-cross"></i>
                                <div>
                                    <strong>Credencial Eclesiástica <span class="reg-doc-obrig">* Obrigatório</span></strong>
                                    <small>Credencial ministerial atual (frente e verso)</small>
                                </div>
                            </div>
                            <label class="reg-doc-btn">
                                <i class="fas fa-paperclip"></i> Escolher
                                <input type="file" accept="image/*,.pdf" class="reg-doc-input" data-tipo="credencial_eclesiastica" data-required="true" hidden>
                            </label>
                            <span class="reg-doc-status"></span>
                        </div>

                        <div class="reg-doc-item" id="regDocCertidao" data-tipo="certidao_casamento" style="display:none;">
                            <div class="reg-doc-info">
                                <i class="fas fa-ring"></i>
                                <div>
                                    <strong>Certidão de Casamento <span class="reg-doc-obrig">* Obrigatório</span></strong>
                                    <small>Obrigatório para estado civil casado(a)</small>
                                </div>
                            </div>
                            <label class="reg-doc-btn">
                                <i class="fas fa-paperclip"></i> Escolher
                                <input type="file" accept="image/*,.pdf" class="reg-doc-input" data-tipo="certidao_casamento" data-required="true" hidden>
                            </label>
                            <span class="reg-doc-status"></span>
                        </div>

                        <div class="reg-doc-item" data-tipo="carta_recomendacao">
                            <div class="reg-doc-info">
                                <i class="fas fa-envelope-open-text"></i>
                                <div>
                                    <strong>Carta de Recomendação Pastoral</strong>
                                    <small>Carta do pastor ou líder que o recomenda</small>
                                </div>
                            </div>
                            <label class="reg-doc-btn">
                                <i class="fas fa-paperclip"></i> Escolher
                                <input type="file" accept="image/*,.pdf" class="reg-doc-input" data-tipo="carta_recomendacao" hidden>
                            </label>
                            <span class="reg-doc-status"></span>
                        </div>

                        <div class="reg-doc-item" data-tipo="certificado_teologico">
                            <div class="reg-doc-info">
                                <i class="fas fa-graduation-cap"></i>
                                <div>
                                    <strong>Certificado Teológico</strong>
                                    <small>Se possuir, envie o certificado ou diploma</small>
                                </div>
                            </div>
                            <label class="reg-doc-btn">
                                <i class="fas fa-paperclip"></i> Escolher
                                <input type="file" accept="image/*,.pdf" class="reg-doc-input" data-tipo="certificado_teologico" hidden>
                            </label>
                            <span class="reg-doc-status"></span>
                        </div>
                    </div>

                    <div class="reg-actions">
                        <!-- Sem voltar: cadastro já foi salvo no passo 3 -->
                        <button type="button" class="reg-btn-next" id="regUploadBtn" onclick="regUploadDocs()">
                            <i class="fas fa-cloud-upload-alt"></i> Enviar Documentos
                        </button>
                        <button type="button" class="reg-btn-skip" id="regSkipBtn" onclick="regFinish()">
                            Pular e acessar o painel <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- ===== SUCESSO ===== -->
                <div class="reg-panel" id="regPanelSuccess">
                    <div class="reg-success">
                        <div class="reg-success-icon"><i class="fas fa-check-circle"></i></div>
                        <h3>Cadastro Realizado com Sucesso!</h3>
                        <p>Bem-vindo(a) à CIEIB! Seu acesso está liberado.</p>
                        <p class="reg-success-detail">Você receberá uma notificação de boas-vindas no seu painel.</p>
                        <button type="button" class="reg-btn-next" onclick="regGoToPanel()">
                            <i class="fas fa-sign-in-alt"></i> Acessar Área do Ministro
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col footer-about">
                    <div class="footer-logo">
                        <div class="logo-icon"><i class="fas fa-dove"></i></div>
                        <span>CIEIB</span>
                    </div>
                    <p data-config="footer_sobre">Convenção das Igrejas Evangélicas Interdenominacional do Brasil — promovendo a unidade e o crescimento do evangelho em todo o território nacional.</p>
                    <div class="footer-social" id="footerSocial">
                        <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="#" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h3>Institucional</h3>
                    <ul>
                        <li><a href="quem-somos.html">Quem Somos</a></li>
                        <li><a href="diretoria.html">Diretoria</a></li>
                        <li><a href="diretoria.html#presidente">Presidente</a></li>
                        <li><a href="quem-somos.html#estrutura">Conselhos</a></li>
                        <li><a href="quem-somos.html#estrutura">Comissões</a></li>
                        <li><a href="quem-somos.html#estrutura">Órgãos</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Convenções</h3>
                    <ul>
                        <li><a href="index.html#convencoes-section">Convenções Afiliadas</a></li>
                        <li><a href="index.html#eventos">Assembleias Convencionais</a></li>
                        <li><a href="index.html#resolucoes">Resoluções</a></li>
                        <li><a href="noticias.html">Notícias</a></li>
                        <li><a href="midias.html">Mídias</a></li>
                    </ul>
                    <ul id="footerExtraLinks"></ul>
                </div>
                <div class="footer-col">
                    <h3>Contato</h3>
                    <ul class="footer-contact">
                        <li>
                            <i class="fas fa-map-marker-alt"></i>
                            <span data-config="site_endereco">Rua Exemplo, 1000<br>Bairro Centro<br>CEP 00000-000<br>Cidade - UF</span>
                        </li>
                        <li>
                            <i class="fas fa-phone"></i>
                            <span data-config="site_telefone">(00) 0000-0000</span>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <span data-config="site_email">contato@cieib.org.br</span>
                        </li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Atendimento</h3>
                    <div class="footer-hours">
                        <p><i class="fas fa-clock"></i> <span data-config="site_horario">Seg a Sex: 09h às 17h</span></p>
                    </div>
                    <a href="contato.html" class="btn btn-outline btn-sm">Fale Conosco</a>
                    <div class="footer-dpo">
                        <a href="lgpd.html">Fale com o DPO</a>
                        <a href="lgpd.html">Política de Privacidade</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <p data-config="footer_copyright">Copyright &copy; CIEIB 2026. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <button class="back-to-top" id="backToTop" aria-label="Voltar ao topo">
        <i class="fas fa-chevron-up"></i>
    </button>
    <a href="https://wa.me/5500000000000" class="whatsapp-float" id="whatsappFloat" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp (abre em nova janela)">
        <i class="fab fa-whatsapp"></i>
    </a>

    <script src="js/main.js"></script>
    <script src="js/api.js"></script>
    <script>
        // ==================== LOGIN ====================
        if (API.isLoggedIn()) {
            API.verifyToken().then(valid => {
                if (valid) window.location.href = 'painel-ministro.html';
            });
        }

        function togglePassword() {
            const input = document.getElementById('loginPassword');
            const icon = document.querySelector('.am-toggle-password i');
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.replace('fa-eye', 'fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.replace('fa-eye-slash', 'fa-eye');
            }
        }

        const loginForm = document.getElementById('ministerLoginForm');
        if (loginForm) {
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const btn = loginForm.querySelector('button[type="submit"]');
                const original = btn.innerHTML;
                const cpfRaw = document.getElementById('loginCpf').value.trim();
                const cpf = cpfRaw; // Enviar valor bruto — backend aceita CPF ou nº credencial
                const senha = document.getElementById('loginPassword').value;
                const msgAnterior = loginForm.querySelector('.login-error');
                if (msgAnterior) msgAnterior.remove();
                btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Autenticando...';
                btn.disabled = true;
                try {
                    const data = await API.login(cpf, senha);
                    btn.textContent = '';
                    const icon = document.createElement('i');
                    icon.className = 'fas fa-check';
                    btn.appendChild(icon);
                    btn.appendChild(document.createTextNode(' Bem-vindo, ' + data.ministro.nome + '!'));
                    btn.style.background = '#28a745';
                    btn.style.borderColor = '#28a745';
                    setTimeout(() => { window.location.href = 'painel-ministro.html'; }, 1200);
                } catch (err) {
                    btn.innerHTML = original;
                    btn.disabled = false;
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'login-error';
                    errorDiv.setAttribute('role', 'alert');
                    errorDiv.innerHTML = '<i class="fas fa-exclamation-triangle"></i> ' + escHtml(err.message || 'CPF ou senha incorretos.');
                    errorDiv.style.cssText = 'background:#fef2f2;color:#d93025;padding:12px 16px;border-radius:8px;font-size:0.85rem;margin-top:12px;display:flex;align-items:center;gap:8px;border:1px solid #fecdd3;';
                    loginForm.appendChild(errorDiv);
                    loginForm.style.animation = 'shake 0.5s ease';
                    setTimeout(() => loginForm.style.animation = '', 500);
                }
            });
        }

        // ==================== MODAL PRIMEIRO ACESSO ====================
        let regCurrentStep = 1;
        let regMinistroId = null;
        let regToken = null;

        // Abrir / Fechar modal
        document.getElementById('btnPrimeiroAcesso').addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('regOverlay').classList.add('open');
            document.body.style.overflow = 'hidden';
        });
        document.getElementById('btnFiliar').addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('regOverlay').classList.add('open');
            document.body.style.overflow = 'hidden';
        });
        document.getElementById('regClose').addEventListener('click', () => {
            document.getElementById('regOverlay').classList.remove('open');
            document.body.style.overflow = '';
        });
        document.getElementById('regOverlay').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) {
                document.getElementById('regOverlay').classList.remove('open');
                document.body.style.overflow = '';
            }
        });

        // Mostrar campos cônjuge conforme estado civil + certidão de casamento
        document.getElementById('regEstadoCivil').addEventListener('change', function() {
            const show = this.value === 'casado';
            document.getElementById('regConjugeGroup').style.display = show ? '' : 'none';
            document.getElementById('regConjugeNascGroup').style.display = show ? '' : 'none';
            // Mostrar/ocultar certidão de casamento na etapa de documentos
            const certidaoItem = document.getElementById('regDocCertidao');
            if (certidaoItem) {
                certidaoItem.style.display = show ? '' : 'none';
                certidaoItem.classList.toggle('reg-doc-required', show);
                const certInput = certidaoItem.querySelector('.reg-doc-input');
                if (certInput) certInput.dataset.required = show ? 'true' : 'false';
            }
        });

        // Adicionar filhos
        let filhoCount = 0;
        document.getElementById('btnAddFilho').addEventListener('click', () => {
            filhoCount++;
            const div = document.createElement('div');
            div.className = 'reg-filho-row';
            div.innerHTML = `
                <input type="text" placeholder="Nome do filho(a)" class="reg-filho-nome">
                <input type="date" class="reg-filho-nasc" title="Data de nascimento">
                <button type="button" class="reg-filho-remove" onclick="this.parentElement.remove()" title="Remover"><i class="fas fa-times"></i></button>
            `;
            document.getElementById('regFilhosContainer').appendChild(div);
        });

        // Máscara CPF
        document.getElementById('regCpf').addEventListener('input', function() {
            let v = this.value.replace(/\D/g, '');
            if (v.length > 11) v = v.slice(0, 11);
            if (v.length > 9) v = v.replace(/(\d{3})(\d{3})(\d{3})(\d{1,2})/, '$1.$2.$3-$4');
            else if (v.length > 6) v = v.replace(/(\d{3})(\d{3})(\d{1,3})/, '$1.$2.$3');
            else if (v.length > 3) v = v.replace(/(\d{3})(\d{1,3})/, '$1.$2');
            this.value = v;
        });

        // Máscara telefone/whatsapp
        ['regTelefone', 'regWhatsapp'].forEach(id => {
            document.getElementById(id).addEventListener('input', function() {
                let v = this.value.replace(/\D/g, '');
                if (v.length > 11) v = v.slice(0, 11);
                if (v.length > 10) v = v.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                else if (v.length > 6) v = v.replace(/(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
                else if (v.length > 2) v = v.replace(/(\d{2})(\d{0,5})/, '($1) $2');
                this.value = v;
            });
        });

        // Máscara CEP + busca automática
        document.getElementById('regCep').addEventListener('input', function() {
            let v = this.value.replace(/\D/g, '');
            if (v.length > 8) v = v.slice(0, 8);
            if (v.length > 5) v = v.replace(/(\d{5})(\d{1,3})/, '$1-$2');
            this.value = v;
            if (v.replace(/\D/g, '').length === 8) buscarCep(v.replace(/\D/g, ''));
        });

        async function buscarCep(cep) {
            try {
                const res = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                const data = await res.json();
                if (!data.erro) {
                    document.getElementById('regEndereco').value = data.logradouro || '';
                    document.getElementById('regBairro').value = data.bairro || '';
                    document.getElementById('regCidade').value = data.localidade || '';
                    document.getElementById('regUf').value = data.uf || '';
                }
            } catch(e) {}
        }

        // Navegação entre etapas
        function regNextStep(step) {
            // Validar etapa atual antes de avançar
            if (step > regCurrentStep) {
                if (!regValidateStep(regCurrentStep)) return;
            }

            // Esconder todas as panels
            document.querySelectorAll('.reg-panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.reg-step').forEach(s => {
                s.classList.remove('active');
                const sn = parseInt(s.dataset.step);
                if (sn < step) s.classList.add('done');
                else s.classList.remove('done');
                if (sn === step) s.classList.add('active');
            });

            document.getElementById('regPanel' + step).classList.add('active');
            regCurrentStep = step;

            // Scroll modal to top
            document.querySelector('.reg-modal').scrollTop = 0;
        }

        function regValidateStep(step) {
            let valid = true;
            const panel = document.getElementById('regPanel' + step);
            const required = panel.querySelectorAll('[required]');
            required.forEach(input => {
                input.classList.remove('reg-invalid');
                if (!input.value.trim()) {
                    input.classList.add('reg-invalid');
                    valid = false;
                }
            });

            if (step === 1) {
                const cpf = document.getElementById('regCpf').value.replace(/\D/g, '');
                if (cpf.length !== 11) {
                    document.getElementById('regCpf').classList.add('reg-invalid');
                    valid = false;
                }
                // Validar todos os campos obrigatórios da etapa 1
                const camposObrig = [
                    { id: 'regNome', msg: 'Nome' },
                    { id: 'regCpf', msg: 'CPF' },
                    { id: 'regRg', msg: 'RG' },
                    { id: 'regNascimento', msg: 'Data de Nascimento' },
                    { id: 'regSexo', msg: 'Sexo' },
                    { id: 'regEstadoCivil', msg: 'Estado Civil' },
                    { id: 'regCidadeNasc', msg: 'Cidade de Nascimento' },
                    { id: 'regPai', msg: 'Nome do Pai' },
                    { id: 'regMae', msg: 'Nome da Mãe' },
                    { id: 'regEmail', msg: 'Email' },
                    { id: 'regTelefone', msg: 'Telefone' },
                    { id: 'regEscolaridade', msg: 'Escolaridade' }
                ];
                const faltando = [];
                camposObrig.forEach(c => {
                    const el = document.getElementById(c.id);
                    if (!el.value.trim()) {
                        el.classList.add('reg-invalid');
                        faltando.push(c.msg);
                        valid = false;
                    }
                });
                if (faltando.length > 0) {
                    alert('Preencha todos os campos obrigatórios:\n• ' + faltando.join('\n• '));
                }
            }

            if (!valid) {
                const first = panel.querySelector('.reg-invalid');
                if (first) first.focus();
            }
            return valid;
        }

        // Submeter formulário (etapa 3 → salva no banco, senha auto-gerada)
        async function regSubmitForm() {
            if (!regValidateStep(3)) return;

            const btn = document.getElementById('regSubmitBtn');
            const original = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Cadastrando...';
            btn.disabled = true;

            // Coletar filhos
            const filhos = [];
            document.querySelectorAll('.reg-filho-row').forEach(row => {
                const nome = row.querySelector('.reg-filho-nome').value.trim();
                const nascimento = row.querySelector('.reg-filho-nasc').value;
                if (nome) filhos.push({ nome, data_nascimento: nascimento || null });
            });

            const cpfVal = document.getElementById('regCpf').value;

            const body = {
                nome: document.getElementById('regNome').value.trim(),
                cpf: cpfVal,
                rg: document.getElementById('regRg').value.trim(),
                orgao_expedidor: document.getElementById('regOrgao').value.trim(),
                data_nascimento: document.getElementById('regNascimento').value,
                sexo: document.getElementById('regSexo').value,
                nacionalidade: document.getElementById('regNacionalidade').value.trim(),
                naturalidade_estado: document.getElementById('regEstadoNasc').value,
                naturalidade_cidade: document.getElementById('regCidadeNasc').value.trim(),
                estado_civil: document.getElementById('regEstadoCivil').value,
                nome_conjuge: document.getElementById('regConjuge').value.trim(),
                data_nasc_conjuge: document.getElementById('regConjugeNasc').value || null,
                pai: document.getElementById('regPai').value.trim(),
                mae: document.getElementById('regMae').value.trim(),
                email: document.getElementById('regEmail').value.trim(),
                telefone: document.getElementById('regTelefone').value.trim(),
                whatsapp: document.getElementById('regWhatsapp').value.trim(),
                escolaridade: document.getElementById('regEscolaridade').value,
                cep: document.getElementById('regCep').value.trim(),
                endereco: document.getElementById('regEndereco').value.trim(),
                numero: document.getElementById('regNumero').value.trim(),
                complemento: document.getElementById('regComplemento').value.trim(),
                bairro: document.getElementById('regBairro').value.trim(),
                cidade: document.getElementById('regCidade').value.trim(),
                uf: document.getElementById('regUf').value,
                cargo: document.getElementById('regCargo').value,
                funcao_ministerial: document.getElementById('regFuncao').value.trim(),
                nome_igreja: document.getElementById('regIgreja').value.trim(),
                tempo_ministerio: document.getElementById('regTempoMinisterio').value,
                data_consagracao: document.getElementById('regConsagracao').value || null,
                data_batismo: document.getElementById('regDataBatismo').value || null,
                data_ordenacao: document.getElementById('regDataOrdenacao').value || null,
                igreja_ordenacao: document.getElementById('regIgrejaOrdenacao').value.trim(),
                cidade_ordenacao: document.getElementById('regCidadeOrdenacao').value.trim(),
                filhos
            };

            try {
                const res = await fetch('/api/registro', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await res.json();
                if (!res.ok) throw new Error(data.error || 'Erro no cadastro');

                regMinistroId = data.ministro.id;
                regToken = data.token;

                // Salvar token para acesso
                localStorage.setItem('cieib_token', data.token);
                localStorage.setItem('cieib_usuario', data.ministro.nome);
                localStorage.setItem('cieib_cpf', data.ministro.cpf);
                localStorage.setItem('cieib_logado', 'true');
                API.token = data.token;

                // Mostrar popup de boas-vindas com dados de login
                const cpfLimpo = cpfVal.replace(/\D/g, '');
                const senhaGerada = cpfLimpo.substring(0, 6);
                const cpfFormatado = cpfLimpo.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
                showWelcomePopup(data.ministro.nome, cpfFormatado, senhaGerada);

                regNextStep(4);
            } catch (err) {
                alert(err.message);
                btn.innerHTML = original;
                btn.disabled = false;
            }
        }

        // Popup de boas-vindas com dados de login
        function showWelcomePopup(nome, cpf, senha) {
            // Remover popup anterior se existir
            const prev = document.getElementById('welcomePopup');
            if (prev) prev.remove();

            const popup = document.createElement('div');
            popup.id = 'welcomePopup';
            popup.innerHTML = `
                <div class="welcome-popup-backdrop" onclick="closeWelcomePopup()"></div>
                <div class="welcome-popup-card">
                    <div class="welcome-popup-icon"><i class="fas fa-check-circle"></i></div>
                    <h3>Olá, ${escHtml(nome)}!</h3>
                    <p class="welcome-popup-subtitle">Seja Bem-Vindo(a) à CIEIB!</p>
                    <p>Seu cadastro foi realizado com sucesso. Abaixo estão seus dados de acesso:</p>
                    <div class="welcome-popup-credentials">
                        <div class="welcome-popup-field">
                            <span class="welcome-popup-label"><i class="fas fa-user"></i> Login (CPF):</span>
                            <span class="welcome-popup-value">${escHtml(cpf)}</span>
                        </div>
                        <div class="welcome-popup-field">
                            <span class="welcome-popup-label"><i class="fas fa-lock"></i> Senha:</span>
                            <span class="welcome-popup-value">${senha}</span>
                        </div>
                    </div>
                    <p class="welcome-popup-warning"><i class="fas fa-exclamation-triangle"></i> Recomendamos que altere sua senha após o primeiro login.</p>
                    <button class="welcome-popup-btn" onclick="closeWelcomePopup()">
                        <i class="fas fa-thumbs-up"></i> Entendi!
                    </button>
                </div>
            `;
            document.body.appendChild(popup);
            setTimeout(() => popup.classList.add('open'), 50);
        }

        function closeWelcomePopup() {
            const popup = document.getElementById('welcomePopup');
            if (popup) {
                popup.classList.remove('open');
                setTimeout(() => popup.remove(), 350);
            }
        }

        // Upload de documentos (etapa 4)
        // Feedback visual ao escolher arquivo
        document.querySelectorAll('.reg-doc-input').forEach(input => {
            input.addEventListener('change', function() {
                const item = this.closest('.reg-doc-item');
                const status = item.querySelector('.reg-doc-status');
                if (this.files.length > 0) {
                    const file = this.files[0];
                    const sizeMB = (file.size / 1024 / 1024).toFixed(1);
                    status.innerHTML = `<i class="fas fa-check-circle" style="color:var(--success)"></i> ${file.name} (${sizeMB}MB)`;
                    item.classList.add('selected');
                } else {
                    status.innerHTML = '';
                    item.classList.remove('selected');
                }
            });
        });

        async function regUploadDocs() {
            const inputs = document.querySelectorAll('.reg-doc-input');
            const formData = new FormData();
            const tipos = [];
            let count = 0;

            // Verificar documentos obrigatórios
            const docsObrigFaltando = [];
            inputs.forEach(input => {
                const item = input.closest('.reg-doc-item');
                if (input.dataset.required === 'true' && item.style.display !== 'none') {
                    if (input.files.length === 0) {
                        const nome = item.querySelector('strong').textContent.replace('* Obrigatório', '').trim();
                        docsObrigFaltando.push(nome);
                        item.style.borderColor = '#e53e3e';
                        item.style.background = '#fef2f2';
                    } else {
                        item.style.borderColor = '';
                        item.style.background = '';
                    }
                }
            });

            if (docsObrigFaltando.length > 0) {
                alert('Envie todos os documentos obrigatórios:\n• ' + docsObrigFaltando.join('\n• '));
                return;
            }

            inputs.forEach(input => {
                if (input.files.length > 0) {
                    formData.append('documentos', input.files[0]);
                    tipos.push(input.dataset.tipo);
                    count++;
                }
            });

            if (count === 0) {
                alert('Selecione ao menos um documento para enviar.');
                return;
            }

            formData.append('ministro_id', regMinistroId);
            formData.append('tipos', JSON.stringify(tipos));

            const btn = document.getElementById('regUploadBtn');
            const original = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';
            btn.disabled = true;

            try {
                const headers = {};
                if (regToken) headers['Authorization'] = `Bearer ${regToken}`;
                const res = await fetch('/api/registro/documentos', {
                    method: 'POST',
                    headers,
                    body: formData
                });
                const data = await res.json();
                if (!res.ok) throw new Error(data.error || 'Erro no upload');

                // Mostrar painel de sucesso
                document.querySelectorAll('.reg-panel').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.reg-step').forEach(s => s.classList.add('done'));
                document.getElementById('regPanelSuccess').classList.add('active');
            } catch (err) {
                alert(err.message);
                btn.innerHTML = original;
                btn.disabled = false;
            }
        }

        function regFinish() {
            document.querySelectorAll('.reg-panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.reg-step').forEach(s => s.classList.add('done'));
            document.getElementById('regPanelSuccess').classList.add('active');
        }

        function regGoToPanel() {
            window.location.href = 'painel-ministro.html';
        }
    </script>

    <style>
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-8px); }
            40%, 80% { transform: translateX(8px); }
        }

        /* ==================== MODAL REGISTRO ==================== */
        .reg-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            z-index: 10000;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
            overflow-y: auto;
        }
        .reg-overlay.open {
            display: flex;
        }
        .reg-modal {
            background: #fff;
            border-radius: 16px;
            width: 100%;
            max-width: 780px;
            margin: 30px auto;
            position: relative;
            box-shadow: 0 25px 80px rgba(0,0,0,0.3);
            max-height: 92vh;
            overflow-y: auto;
            animation: regSlideIn 0.35s ease;
        }
        @keyframes regSlideIn {
            from { opacity: 0; transform: translateY(40px) scale(0.97); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .reg-close {
            position: sticky;
            top: 10px;
            float: right;
            margin: 10px 14px 0 0;
            background: none;
            border: none;
            font-size: 28px;
            color: var(--gray);
            cursor: pointer;
            z-index: 10;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        .reg-close:hover { background: var(--light-gray); color: var(--dark); }

        /* Steps indicator */
        .reg-steps {
            display: flex;
            justify-content: center;
            gap: 8px;
            padding: 24px 24px 0;
            margin-bottom: 8px;
        }
        .reg-step {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            border-radius: 24px;
            font-size: 0.78rem;
            font-weight: 600;
            color: var(--gray);
            background: var(--light);
            transition: var(--transition);
        }
        .reg-step-num {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: var(--light-gray);
            color: var(--gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            transition: var(--transition);
        }
        .reg-step.active {
            background: var(--primary);
            color: #fff;
        }
        .reg-step.active .reg-step-num {
            background: rgba(255,255,255,0.25);
            color: #fff;
        }
        .reg-step.done {
            background: #e8f5e9;
            color: var(--success);
        }
        .reg-step.done .reg-step-num {
            background: var(--success);
            color: #fff;
        }
        .reg-step span { display: none; }
        @media (min-width: 600px) {
            .reg-step span { display: inline; }
        }

        /* Panels */
        .reg-panel {
            display: none;
            padding: 20px 32px 32px;
        }
        .reg-panel.active { display: block; }
        .reg-panel-header {
            text-align: center;
            margin-bottom: 24px;
        }
        .reg-panel-header i {
            font-size: 2.2rem;
            color: var(--secondary);
            margin-bottom: 8px;
        }
        .reg-panel-header h3 {
            font-size: 1.4rem;
            color: var(--primary-dark);
            margin: 4px 0;
        }
        .reg-panel-header p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Grid 2 cols */
        .reg-grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px;
        }
        .reg-field.full { grid-column: 1 / -1; }
        .reg-field label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 4px;
        }
        .reg-field input,
        .reg-field select {
            width: 100%;
            padding: 10px 12px;
            border: 1.5px solid var(--light-gray);
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text);
            background: #fff;
            transition: var(--transition);
            font-family: inherit;
        }
        .reg-field input:focus,
        .reg-field select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26,58,92,0.1);
        }
        .reg-field input.reg-invalid,
        .reg-field select.reg-invalid {
            border-color: #e53e3e;
            box-shadow: 0 0 0 3px rgba(229,62,62,0.12);
        }

        /* Filhos */
        .reg-filho-row {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
            align-items: center;
        }
        .reg-filho-row input:first-child { flex: 2; }
        .reg-filho-row input:nth-child(2) { flex: 1; }
        .reg-filho-row input {
            padding: 8px 10px;
            border: 1.5px solid var(--light-gray);
            border-radius: 8px;
            font-size: 0.85rem;
            font-family: inherit;
        }
        .reg-filho-remove {
            background: none;
            border: none;
            color: #e53e3e;
            cursor: pointer;
            font-size: 1rem;
            padding: 4px 8px;
        }
        .reg-btn-add {
            background: none;
            border: 1.5px dashed var(--secondary);
            color: var(--secondary-dark);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 4px;
            transition: var(--transition);
        }
        .reg-btn-add:hover { background: #fdf8ec; }

        /* Divider */
        .reg-divider {
            display: flex;
            align-items: center;
            margin: 24px 0 16px;
            gap: 12px;
        }
        .reg-divider::before, .reg-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--light-gray);
        }
        .reg-divider span {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--primary);
            white-space: nowrap;
        }

        /* Actions */
        .reg-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 28px;
            gap: 12px;
            flex-wrap: wrap;
        }
        .reg-btn-next, .reg-btn-prev {
            padding: 12px 28px;
            border-radius: 8px;
            border: none;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-family: inherit;
        }
        .reg-btn-next {
            background: var(--primary);
            color: #fff;
        }
        .reg-btn-next:hover { background: var(--primary-dark); }
        .reg-btn-prev {
            background: var(--light);
            color: var(--text);
        }
        .reg-btn-prev:hover { background: var(--light-gray); }
        .reg-btn-submit {
            background: var(--success) !important;
        }
        .reg-btn-submit:hover {
            background: #218838 !important;
        }
        .reg-btn-skip {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 0.85rem;
            cursor: pointer;
            text-decoration: underline;
            font-family: inherit;
        }
        .reg-btn-skip:hover { color: var(--primary); }

        /* Documents */
        .reg-docs-list { display: flex; flex-direction: column; gap: 12px; }
        .reg-doc-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            border: 1.5px solid var(--light-gray);
            border-radius: 10px;
            transition: var(--transition);
            flex-wrap: wrap;
        }
        .reg-doc-item.selected { border-color: var(--success); background: #f0fff4; }
        .reg-doc-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
            min-width: 200px;
        }
        .reg-doc-info i {
            font-size: 1.4rem;
            color: var(--secondary);
            width: 32px;
            text-align: center;
        }
        .reg-doc-info strong { display: block; font-size: 0.9rem; color: var(--dark-gray); }
        .reg-doc-info small { color: var(--gray); font-size: 0.78rem; }
        .reg-doc-btn {
            padding: 8px 16px;
            background: var(--light);
            border: 1.5px solid var(--light-gray);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.82rem;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 6px;
            transition: var(--transition);
            white-space: nowrap;
        }
        .reg-doc-btn:hover { background: var(--primary); color: #fff; border-color: var(--primary); }
        .reg-doc-status { font-size: 0.78rem; color: var(--gray); display: flex; align-items: center; gap: 4px; }

        /* Success */
        .reg-success {
            text-align: center;
            padding: 40px 20px;
        }
        .reg-success-icon {
            font-size: 4rem;
            color: var(--success);
            margin-bottom: 16px;
        }
        .reg-success h3 {
            font-size: 1.5rem;
            color: var(--primary-dark);
            margin-bottom: 8px;
        }
        .reg-success p {
            color: var(--text-light);
            margin-bottom: 4px;
        }
        .reg-success-detail {
            font-size: 0.85rem;
            color: var(--gray);
            margin-bottom: 24px !important;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .reg-modal { margin: 10px; border-radius: 12px; }
            .reg-panel { padding: 16px 18px 24px; }
            .reg-grid-2 { grid-template-columns: 1fr; }
            .reg-field.full { grid-column: 1; }
            .reg-steps { gap: 4px; padding: 16px 12px 0; }
            .reg-step { padding: 6px 10px; font-size: 0.7rem; }
            .reg-actions { flex-direction: column; }
            .reg-btn-next, .reg-btn-prev { width: 100%; justify-content: center; }
        }

        /* Document required badge */
        .reg-doc-obrig {
            display: inline-block;
            font-size: 0.68rem;
            font-weight: 700;
            color: #e53e3e;
            margin-left: 4px;
        }
        .reg-doc-required {
            border-color: #fed7aa !important;
            background: #fffbeb;
        }

        /* Welcome Popup */
        #welcomePopup {
            position: fixed;
            inset: 0;
            z-index: 20000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.35s ease;
        }
        #welcomePopup.open { opacity: 1; }
        .welcome-popup-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.55);
        }
        .welcome-popup-card {
            position: relative;
            background: #fff;
            border-radius: 20px;
            padding: 40px 36px 32px;
            max-width: 440px;
            width: 90%;
            text-align: center;
            box-shadow: 0 25px 80px rgba(0,0,0,0.3);
            transform: scale(0.9);
            transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        #welcomePopup.open .welcome-popup-card { transform: scale(1); }
        .welcome-popup-icon {
            font-size: 3.5rem;
            color: #059669;
            margin-bottom: 12px;
        }
        .welcome-popup-card h3 {
            font-size: 1.4rem;
            color: #1a3a5c;
            margin-bottom: 4px;
        }
        .welcome-popup-subtitle {
            font-size: 1rem;
            color: #c8a951;
            font-weight: 600;
            margin-bottom: 12px !important;
        }
        .welcome-popup-card > p {
            font-size: 0.9rem;
            color: #555;
            margin-bottom: 16px;
        }
        .welcome-popup-credentials {
            background: linear-gradient(135deg, #f0f7ff, #e8f4fd);
            border: 2px solid #1a3a5c;
            border-radius: 12px;
            padding: 18px 20px;
            margin: 16px 0;
        }
        .welcome-popup-field {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 0;
        }
        .welcome-popup-field:first-child {
            border-bottom: 1px solid rgba(26,58,92,0.15);
        }
        .welcome-popup-label {
            font-size: 0.85rem;
            color: #555;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .welcome-popup-label i { color: #1a3a5c; }
        .welcome-popup-value {
            font-size: 1rem;
            font-weight: 700;
            color: #1a3a5c;
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }
        .welcome-popup-warning {
            font-size: 0.8rem;
            color: #d97706;
            background: #fffbeb;
            padding: 10px 14px;
            border-radius: 8px;
            margin: 12px 0 !important;
        }
        .welcome-popup-warning i { margin-right: 4px; }
        .welcome-popup-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 32px;
            background: #1a3a5c;
            color: #fff;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 8px;
            font-family: inherit;
        }
        .welcome-popup-btn:hover { background: #2c5a8c; transform: translateY(-1px); }
    </style>
</body>
</html>
